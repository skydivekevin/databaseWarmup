'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _path = require('path');

var _fsExtra = require('fs-extra');

var _fsExtra2 = _interopRequireDefault(_fsExtra);

var _crossSpawn = require('cross-spawn');

var _ora = require('ora');

var _ora2 = _interopRequireDefault(_ora);

var _logSymbols = require('log-symbols');

var _logSymbols2 = _interopRequireDefault(_logSymbols);

var _chalk = require('chalk');

var _chalk2 = _interopRequireDefault(_chalk);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var cwd = process.cwd();

exports.default = async function init() {
	var spinner = (0, _ora2.default)('Setting up your new ExpressX project...').start();
	await _fsExtra2.default.copy((0, _path.join)(__dirname, '../../src/init/template'), (0, _path.join)(cwd, '.'));
	await _fsExtra2.default.ensureDir((0, _path.join)(cwd, 'views/partials'));
	spinner.text = 'Installing dependencies...';
	var proc = (0, _crossSpawn.spawn)('npm', ['install']);
	proc.on('exit', function (code) {
		if (code === 0) {
			spinner.stop();
			console.log();
			console.log(_logSymbols2.default.success, _chalk2.default.green('Woohoo! Everything is good to go!'));
			console.log('To start your app, just run:');
			console.log();
			console.log(_chalk2.default.cyan('    npm start'));
			console.log();
			console.log('Happy coding!');
			process.exit(); // eslint-disable-line unicorn/no-process-exit
		} else {
			spinner.fail('There was an error installing dependencies.');
		}
	});
};